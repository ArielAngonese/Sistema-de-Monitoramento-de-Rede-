<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Página de segurança e detecção de ameaças — NetLab.">
  <title>Security — Segurança e Detecção</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <!-- Barra lateral -->
  <div class="sidebar">
    <h2>Menu</h2>
    <a href="/">Página Inicial</a>
    <a href="/ports">Portas e Protocolos</a>
    <a href="/devices">Dispositivos Conectados</a>
    <a href="/security" class="active">Segurança e Detecção</a>
    <a href="/tools">Diagnóstico de Rede</a>
    <a href="/dashboard">Dashboard</a>
  </div>

  <header>
    <h1>Segurança e Detecção</h1>
  </header>

  <main class="content">
    <!--Introdução e objetivo-->
    <section class="section">
  <h2>Detecção de Ameaças e Análise de Tráfego</h2>
  <p>
    A detecção de ameaças em redes é um processo essencial para compreender o comportamento do tráfego e identificar atividades potencialmente maliciosas. 
    Por meio da captura e análise de pacotes, é possível observar o fluxo de dados que circula entre dispositivos e detectar padrões que indicam 
    varreduras, tentativas de acesso não autorizado ou uso indevido dos recursos da rede.
  </p>
  <p>
    Nesta página, o usuário pode acompanhar, de forma prática, como ocorre a <strong>análise de tráfego em tempo real</strong> e como regras simples de 
    detecção podem sinalizar comportamentos suspeitos. Essa abordagem demonstra, de forma didática, os princípios fundamentais por trás de um 
    <strong>Sistema de Detecção de Intrusões (IDS)</strong>, tecnologia amplamente utilizada em ambientes corporativos para monitorar e proteger redes contra ataques.
  </p>
  <p>
    Ao interagir com as ferramentas disponíveis, é possível compreender a importância do monitoramento contínuo e o papel das análises automatizadas na 
    identificação de anomalias, fornecendo uma base prática para o estudo da segurança em redes de computadores.
  </p>
</section>


    <section class="section">
  <h2>Ferramentas Utilizadas</h2>
  <ul>
    <li>
      <strong>Scapy:</strong> principal ferramenta utilizada nesta página para a <strong>captura e análise de pacotes de rede</strong>. 
      Permite observar o tráfego em tempo real, identificar protocolos utilizados, endereços de origem e destino, e tipos de pacotes trocados. 
      É amplamente usada em pesquisas, testes de segurança e aprendizado sobre camadas de rede.
    </li>
  </ul>
  <p>
    O uso dessa ferramenta permite demonstrar, de forma prática, como softwares profissionais de análise de tráfego 
    operam, tornando mais acessível a compreensão sobre protocolos de comunicação, inspeção de pacotes e monitoramento de redes.
  </p>
</section>

    <!--O que será experimentado-->
    <section class="section">
      <h2>O Que Será Experimentado</h2>
      <p>
        No experimento você iniciará uma captura controlada de pacotes por um intervalo curto (10 segundos). O sistema analisará os pacotes coletados e caso algo suspeito seja detectado,
        ao final, serão exibidos:
      </p>
      <ul>
        <li>Resumo dos endereços fonte mais frequentes;</li>
        <li>Tipos de protocolos observados (TCP, UDP, ICMP);</li>
        <li>Qualquer alerta gerado pelas regras (ex.: IPs com contagem anômala de pacotes).</li>
      </ul>
      <p>
        Essa experiência permite entender como a análise imediata do tráfego pode evidenciar comportamentos atípicos e suportar investigações iniciais.
      </p>
    </section>

    <!--Experimente-->
    <section class="section card-experimente">
      <h2>Experimente</h2>
      <p>
        Clique no botão abaixo para iniciar uma captura de pacotes controlada (10 segundos). Aguarde o processamento e visualize os resultados no painel de saída.
      </p>

      <button id="btnCapture" onclick="captureSecurity()">Iniciar Captura (10s)</button>

      <noscript>
        <p style="color:#f4b400">Javascript é necessário para executar a captura interativa. Ative o JavaScript e recarregue a página.</p>
      </noscript>
      <pre id="securityOutput" aria-live="polite" role="status"></pre>
      
    </section>

    <!-- Sessão: Simulação de Ataque -->
    <section class="section card-experimente">
        <h2>Simulação de Ataque DDoS</h2>
        <p>Utilize o botão abaixo para simular um ataque DDoS e visualizar como o sistema detecta tráfego anômalo, uma vez que na maioria dos casos em que você executar a captura acima,
          nada será detectado. Caso o sistema detectasse algum ataque, os alertas seriam exibitos dessa maneira. OBS.: nenhuma das informações abaixo são reais, são apenas exemplos educativos.
        </p>
        <button id="simulateBtn">Simular ataque DDoS</button>
        <pre id="simulateResult" aria-live="polite" role="status"></pre>
    </section>
    
    <script>
  document.getElementById('simulateBtn').addEventListener('click', async function() {
    const btn = this;
    const out = document.getElementById('simulateResult');
    btn.disabled = true;
    btn.textContent = 'Simulando...';
    out.textContent = '';
    try {
      const resp = await fetch('/security_simulate_ddos');
      if (!resp.ok) {
        out.textContent = 'Erro na simulação: ' + resp.statusText;
        return;
      }
      const data = await resp.json();
      if (data.status === 'ok') {
        out.textContent = (data.alerts && data.alerts.length) ? data.alerts.join('\n') : 'Nenhum ataque detectado.';
      } else {
        out.textContent = data.mensagem || 'Erro desconhecido.';
      }
    } catch (err) {
      out.textContent = 'Falha na requisição: ' + (err && err.message ? err.message : String(err));
    } finally {
      btn.disabled = false;
      btn.textContent = 'Simular ataque DDoS';
    }
  });

  // Função para captura de pacotes e preenchimento do painel
  async function captureSecurity() {
    const btn = document.getElementById('btnCapture');
    const out = document.getElementById('securityOutput');
    const ipList = document.getElementById('ipList');
    const protoList = document.getElementById('protoList');
    const alertList = document.getElementById('alertList');
    btn.disabled = true;
    btn.textContent = 'Capturando...';
    out.textContent = '';
    ipList.innerHTML = '';
    protoList.innerHTML = '';
    alertList.innerHTML = '';
    try {
      const resp = await fetch('/security_capture');
      if (!resp.ok) {
        out.textContent = 'Erro na captura: ' + resp.statusText;
        return;
      }
      const data = await resp.json();
      // Exibe alertas
      if (data.alerts && Array.isArray(data.alerts)) {
        data.alerts.forEach(a => {
          const li = document.createElement('li');
          li.textContent = a;
          alertList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = 'Nenhum alerta gerado.';
        alertList.appendChild(li);
      }
      // Exibe IPs mais frequentes
      if (data.ip_summary && Array.isArray(data.ip_summary)) {
        data.ip_summary.forEach(ip => {
          const li = document.createElement('li');
          li.textContent = ip;
          ipList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = 'Nenhum IP detectado.';
        ipList.appendChild(li);
      }
      // Exibe protocolos
      if (data.protocols && Array.isArray(data.protocols)) {
        data.protocols.forEach(proto => {
          const li = document.createElement('li');
          li.textContent = proto;
          protoList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = 'Nenhum protocolo detectado.';
        protoList.appendChild(li);
      }
    } catch (err) {
      out.textContent = 'Falha na requisição: ' + (err && err.message ? err.message : String(err));
    } finally {
      btn.disabled = false;
      btn.textContent = 'Iniciar Captura (10s)';
    }
  }
    </script>

    <!--Regras de detecção-->
    <section class="section">
      <h2>Regras de Detecção</h2>
      <p>
        As regras implementadas neste laboratório são propositalmente simples e têm caráter didático. Exemplos:
      </p>
      <ul>
        <li><strong>Contagem por IP:</strong> se um único endereço enviar mais de N pacotes no período de captura, gera alerta (indicador possível de DoS/scan).</li>
        <li><strong>Port scan rápido:</strong> múltiplas tentativas de conexão a portas distintas num intervalo curto sugerem varredura de portas.</li>
        <li><strong>Pacotes ICMP em excesso:</strong> fluxo anormal de ICMP pode indicar varredura ou diagnóstico malicioso.</li>
      </ul>
      <p>
        Essas regras não substituem assinaturas complexas, mas são eficazes para demonstrar o funcionamento básico de um sistema de detecção e para ensinar como correlacionar eventos.
      </p>
    </section>

    <!-- Seção: Aplicações e Relevância em Segurança -->
<section class="section">
  <h2>Aplicações e Relevância</h2>

  <p>
    A seção de <strong>Segurança e Detecção</strong> do NetLab oferece ferramentas práticas para compreender, 
    na prática, como funcionam atividades fundamentais de defesa cibernética. Por meio da análise de pacotes, 
    detecção de tráfego suspeito e simulações de ataques, o usuário pode observar comportamentos reais de rede 
    e reconhecer indicadores de comprometimento (IoCs) que frequentemente aparecem em ambientes corporativos.
  </p>

  <ul>
    <li>
      <strong>Identificação de tráfego anômalo:</strong> o sistema exibe alertas quando detecta volume incomum 
      de pacotes vindos de um mesmo IP, técnica essencial para reconhecer ataques de negação de serviço (DoS/DDoS).
    </li>

    <li>
      <strong>Monitoramento de protocolos:</strong> a análise de pacotes permite avaliar quais protocolos estão 
      sendo utilizados (TCP, UDP, ICMP etc.) e identificar comportamentos fora do padrão, como grande número de 
      requisições ICMP ou conexões UDP inesperadas.
    </li>

    <li>
      <strong>Compreensão de ataques simulados:</strong> a simulação de DDoS ajuda o usuário a visualizar como 
      múltiplas fontes podem gerar sobrecarga em um sistema, reforçando conceitos de mitigação, limites de taxa 
      e listas de controle de acesso.
    </li>

    <li>
      <strong>Análise comportamental:</strong> ao capturar pacotes em tempo real, o usuário pode estudar a 
      dinâmica da comunicação entre dispositivos e detectar elementos suspeitos, como portas incomuns, tráfego 
      repetitivo, broadcast excessivo ou varreduras de rede.
    </li>

    <li>
      <strong>Educação prática em segurança:</strong> a visualização direta do tráfego permite relacionar 
      teoria e prática, compreendendo como ataques acontecem e quais sinais podem indicar um incidente.
    </li>
  </ul>

  <p>
    A integração dessas ferramentas torna a página de Segurança um componente essencial do NetLab, capacitando o 
    usuário a interpretar pacotes, detectar anomalias e entender em profundidade como ameaças se manifestam em 
    ambientes reais. Esse tipo de prática é indispensável para quem busca desenvolver habilidades profissionais 
    em <strong>cibersegurança, análise de tráfego e resposta a incidentes</strong>.
  </p>
</section>

  </main>

  <footer>
    <p>NetLab — Plataforma Interativa de Cibersegurança Aplicada | Ariel Liotto Angonese e Emanuel Júlio Solivo</p>
  </footer>

  <script>
    async function captureSecurity() {
      const out = document.getElementById('securityOutput');
      const btn = document.getElementById('btnCapture');

      out.textContent = '';
      btn.disabled = true;
      btn.setAttribute('aria-busy', 'true');
      btn.textContent = 'Capturando...';

      try {
        const resp = await fetch('/security_capture');
        if (!resp.ok) {
          const txt = await resp.text().catch(() => resp.statusText);
          out.textContent = `Erro HTTP ${resp.status}: ${txt}`;
          return;
        }

        const data = await resp.json();

        // Formata a resposta de forma legível
        if (data.status === 'ok') {
          const alerts = data.alerts || [];
          const summary = data.summary || null;

          if (alerts.length) {
            out.textContent += 'Alertas detectados:\n';
            alerts.forEach(a => out.textContent += `- ${a}\n`);
            out.textContent += '\n';
          } else {
            out.textContent += 'Nenhum alerta detectado.\n\n';
          }

          if (summary) {
            out.textContent += 'Resumo da captura:\n';
            out.textContent += JSON.stringify(summary, null, 2) + '\n';
          } else if (data.packets) {
            out.textContent += 'Dados brutos (parciais):\n';
            out.textContent += JSON.stringify(data.packets, null, 2) + '\n';
          }
        } else {
          out.textContent = 'Erro: ' + (data.mensagem || JSON.stringify(data));
        }
      } catch (err) {
        out.textContent = 'Falha na requisição: ' + (err && err.message ? err.message : String(err));
      } finally {
        btn.disabled = false;
        btn.removeAttribute('aria-busy');
        btn.textContent = 'Iniciar Captura (10s)';
      }
    }
  </script>
</body>
</html>
